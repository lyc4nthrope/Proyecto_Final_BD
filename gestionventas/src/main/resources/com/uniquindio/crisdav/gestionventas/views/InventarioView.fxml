<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>


<ScrollPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.uniquindio.crisdav.gestionventas.controllers.views.InventarioViewController">
   <content>
      <VBox spacing="15" style="-fx-padding: 20;">
      
          <!-- TÃ­tulo -->
          <HBox alignment="CENTER_LEFT" spacing="10">
              <Label style="-fx-font-size: 24; -fx-font-weight: bold;" text="ðŸ“Š Reporte de Inventario" />
              <Region HBox.hgrow="ALWAYS" />
              <Button onAction="#cargarInventario" style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-font-size: 13; -fx-padding: 8 15;" text="ðŸ”„ Actualizar" />
              <Button onAction="#exportarPDF" style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-font-size: 13; -fx-padding: 8 15; -fx-font-weight: bold;" text="ðŸ“„ Exportar PDF" />
              <Button onAction="#imprimirReporte" style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-font-size: 13; -fx-padding: 8 15;" text="ðŸ–¨ï¸ Imprimir" />
          </HBox>
          
          <Separator />
      
          <!-- Filtros y Opciones -->
          <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: #f8f9fa; -fx-padding: 10; -fx-background-radius: 5;">
              <Label style="-fx-font-weight: bold; -fx-font-size: 13;" text="ðŸ“¦ Filtrar por CategorÃ­a:" />
              <ComboBox fx:id="comboCategoriaFiltro" onAction="#aplicarFiltro" prefWidth="180" />
              
              <Separator orientation="VERTICAL" />
              
              <CheckBox fx:id="chkStockBajo" onAction="#aplicarFiltro" text="Mostrar solo stock bajo (menor a 10)" />
              
              <Region HBox.hgrow="ALWAYS" />
              
              <Label fx:id="lblFechaReporte" style="-fx-font-size: 11; -fx-text-fill: #666;" text="Fecha: 15/10/2024" />
          </HBox>
      
          <!-- Panel dividido: Tabla | GrÃ¡fico -->
          <SplitPane dividerPositions="0.65" VBox.vgrow="ALWAYS">
              
              <!-- Panel Izquierdo: Tabla de Inventario -->
              <VBox spacing="10" style="-fx-padding: 5;">
                  <Label style="-fx-font-size: 16; -fx-font-weight: bold;" text="ðŸ“‹ Detalle de Inventario" />
                  
                  <TableView fx:id="tablaInventario" style="-fx-font-size: 12;" VBox.vgrow="ALWAYS">
                      <columns>
                          <TableColumn fx:id="colCategoria" prefWidth="110" style="-fx-alignment: CENTER;" text="CategorÃ­a" />
                          <TableColumn fx:id="colCodigo" prefWidth="100" text="CÃ³digo" />
                          <TableColumn fx:id="colNombre" prefWidth="220" text="Nombre" />
                          <TableColumn fx:id="colStock" prefWidth="80" style="-fx-alignment: CENTER;" text="Stock" />
                          <TableColumn fx:id="colValorAdq" prefWidth="130" style="-fx-alignment: CENTER_RIGHT;" text="Valor AdquisiciÃ³n" />
                          <TableColumn fx:id="colCostoTotal" prefWidth="130" style="-fx-alignment: CENTER_RIGHT;" text="Costo Total" />
                      </columns>
                      <placeholder>
                          <VBox alignment="CENTER" spacing="10">
                              <Label style="-fx-font-size: 48;" text="ðŸ“¦" />
                              <Label style="-fx-font-size: 16; -fx-text-fill: #666;" text="No hay productos en inventario" />
                          </VBox>
                      </placeholder>
                  </TableView>
                  
                  <!-- Resumen por categorÃ­as -->
                  <VBox spacing="8" style="-fx-border-color: #dee2e6; -fx-border-width: 1; -fx-padding: 10; -fx-background-color: #f8f9fa; -fx-border-radius: 5; -fx-background-radius: 5;">
                      <Label style="-fx-font-weight: bold; -fx-font-size: 13;" text="ðŸ’° Resumen por CategorÃ­a" />
                      <GridPane fx:id="gridResumenCategorias" hgap="15" vgap="5">
                    <!-- Se llenarÃ¡ dinÃ¡micamente -->
                </GridPane>
                  </VBox>
              </VBox>
              
              <!-- Panel Derecho: GrÃ¡fico y EstadÃ­sticas -->
              <VBox spacing="15" style="-fx-padding: 5;">
                  <Label style="-fx-font-size: 16; -fx-font-weight: bold;" text="ðŸ“ˆ DistribuciÃ³n del Inventario" />
                  
                  <!-- GrÃ¡fico de pastel -->
                  <PieChart fx:id="graficoInventario" legendVisible="true" prefHeight="300" />
                  
                  <!-- Alertas de Stock -->
                  <VBox spacing="10" style="-fx-border-color: #ffc107; -fx-border-width: 2; -fx-padding: 10; -fx-background-color: #fff3cd; -fx-border-radius: 5; -fx-background-radius: 5;">
                      <Label style="-fx-font-weight: bold; -fx-font-size: 13; -fx-text-fill: #856404;" text="âš ï¸ Alertas de Stock Bajo" />
                      <ScrollPane fitToWidth="true" prefHeight="150" style="-fx-background-color: transparent;">
                          <VBox fx:id="vboxAlertasStock" spacing="5" style="-fx-background-color: transparent;" />
                      </ScrollPane>
                  </VBox>
                  
                  <!-- Top 5 Productos con MÃ¡s Valor -->
                  <VBox spacing="10" style="-fx-border-color: #007bff; -fx-border-width: 2; -fx-padding: 10; -fx-background-color: #e7f3ff; -fx-border-radius: 5; -fx-background-radius: 5;">
                      <Label style="-fx-font-weight: bold; -fx-font-size: 13; -fx-text-fill: #004085;" text="ðŸ’Ž Top 5 - Mayor Valor en Inventario" />
                      <VBox fx:id="vboxTop5" spacing="5" />
                  </VBox>
              </VBox>
              
          </SplitPane>
      
          <!-- EstadÃ­sticas Totales -->
          <HBox alignment="CENTER" spacing="15" style="-fx-padding: 15; -fx-background-color: #343a40; -fx-background-radius: 5;">
              <VBox alignment="CENTER" spacing="5" style="-fx-min-width: 200;">
                  <Label style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;" text="Total Productos" />
                  <Label fx:id="lblTotalProductos" style="-fx-text-fill: white; -fx-font-size: 28; -fx-font-weight: bold;" text="0" />
              </VBox>
              
              <Separator orientation="VERTICAL" style="-fx-background-color: white;" />
              
              <VBox alignment="CENTER" spacing="5" style="-fx-min-width: 200;">
                  <Label style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;" text="Total Unidades" />
                  <Label fx:id="lblTotalUnidades" style="-fx-text-fill: white; -fx-font-size: 28; -fx-font-weight: bold;" text="0" />
              </VBox>
              
              <Separator orientation="VERTICAL" style="-fx-background-color: white;" />
              
              <VBox alignment="CENTER" spacing="5" style="-fx-min-width: 250;">
                  <Label style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;" text="Valor Total Inventario" />
                  <Label fx:id="lblValorTotal" style="-fx-text-fill: #28a745; -fx-font-size: 28; -fx-font-weight: bold;" text=" $0.00" />
              </VBox>
              
              <Separator orientation="VERTICAL" style="-fx-background-color: white;" />
              
              <VBox alignment="CENTER" spacing="5" style="-fx-min-width: 200;">
                  <Label style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;" text="Stock Bajo" />
                  <Label fx:id="lblStockBajo" style="-fx-text-fill: #dc3545; -fx-font-size: 28; -fx-font-weight: bold;" text="0" />
              </VBox>
          </HBox>
      
      </VBox>
   </content>
</ScrollPane>
